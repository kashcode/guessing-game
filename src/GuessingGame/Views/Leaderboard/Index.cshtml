@{
    ViewData["Title"] = "Leaderboard";
}

<div id="app" v-cloak>
    <form>
        <div class="row mb-3">
            <label for="inputEmail3" class="col-sm-2 col-form-label">Games played:</label>
            <div class="col-sm-10">
                <input type="number" class="form-control" v-model.number="gameCount">
            </div>
        </div>
        <button type="button" class="btn btn-primary" v-on:click="search">Search</button>
    </form>
    <div class="table-responsive" style="margin-top: 18px;">
        <table class="table">
            <thead>
                <tr>
                    <th>Rank</th>
                    <th>Player name</th>
                    <th>Total guesses</th>
                    <th>Games played</th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="stat in stats">
                    <td>{{stat.rank}}</td>
                    <td>{{stat.name}}</td>
                    <td>{{stat.totalGuesses}}</td>
                    <td>{{stat.gamesPlayed}}</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

@section Scripts {
    <script src="~/lib/vuejs/vue.js"></script>
    <script>
    new Vue({
        el: '#app',
        data: {
            gameCount: null,
            stats: @Html.Raw(Json.Serialize(ViewData["stats"]))
        },
        methods: {
            search: function () {
                $self = this;

                $.ajax({
                    url: '@Url.Action("GetStats", "Leaderboard")',
                    type: "get",
                    data: {
                        gameCount: $self.gameCount
                    },
                    success: function (response) {
                        $self.stats = response;
                    },
                    error: function () {
                        console.log('error');
                    }
                });
            }
        }
    });
    </script>
}